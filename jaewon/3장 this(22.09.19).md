# 3장 this
- this는 실질적으로 함수와 객체(메서드)의 구분하는 거의 유일한 기능이다.
<br>

## 📌 상황에 따라 달라지는 this
- this는 함수를 호출할 때 결정된다. 즉, 함수를 어떤 방식으로 호출하느냐에 따라 값이 달라진다.

### ✨ 전역 공간에서의 this
```js
var a = 1;
console.log(a); // 1
console.log(window.a); // 1
console.log(this.a); // 1
```
- 전역 공간에서의 this는 전역 객체를 가리킨다.
- 자바스크립트의 모든 변수는 특정 객체의 프로퍼티로서 동작한다.
- 전역변수를 선언하면 자바스크립트 엔진은 이를 전역객체의 프로퍼티로 할당한다.
- 전역변수 선언과 전역객체의 프로퍼티 할당의 차이점은 '삭제' 명령어에 대한 결과이다.
- 전역변수를 선언하면 자바스크립트 엔진이 이를 자동으로 전역객체의 프로퍼티로 할당하면서 추가적으로 해당 프로퍼티의 configurable 속성을 false로 정의한다.
- 즉, 호이스팅 여부 및 configurable 여부 차이를 보인다. 
<br>

### ✨ 메서드로서 호출할 때 그 내부에서의 this
#### 함수 vs 메서드
- 함수와 메서드는 미리 정의한 동작을 수행하는 코드 뭉치로, 이 둘을 구분하는 유일한 차이는 독립성에 있다.
- 함수는 그 자체로 독립적인 기능을 수행하는 반면, 메서드는 자신을 호출한 대상 객체에 관한 동작을 수행한다. 
- 어떤 함수를 객체의 프로퍼티에 할당한다고 해서 그 자체로서 무조건 메서드가 되는 것이 아니라 객체의 메서드로서 호출할 경우에만 메서드로 동작하고, 그렇지 않으면 함수로 동작한다.
- 구분법 : 어떤 함수를 호출할 때 그 함수 이름(프로퍼티명) 앞에 객체가 명시돼 있는 경우에는 메서드로 호출한 것이고, 그렇지 않은 모든 경우에는 함수로 호출한 것이다.

#### 메서드 내부에서의 this
- this에는 호출한 주체에 대한 정보가 담긴다.
- 어떤 함수를 메서드로서 호출하는 경우 호출 주체는 함수명(프로퍼티명) 앞의 객체이다.
<br>

### ✨ 함수로서 호출할 때의 그 함수
#### 함수 내부에서의 this
- 어떤 함수를 함수로서 호출할 경우에는 this가 지정되지 않는다.
- 함수에서의 this는 전역 객체를 가리킨다. 

#### 메서드의 내부함수에서의 this
- this 바인딩에 관해서는 함수를 실행하는 당시의 주변 환경은 중요하지 않고, 오직 해당 함수를 호출하는 구문 앞에 점 또는 대괄호 표기가 있는지 없는지가 관건이다. 

#### 메서드의 내부 함수에서의 this를 우회하는 방법
- 변수를 활용한다. 

#### this를 바인딩하지 않는 함수
- ES6에서는 함수 내부에서 this가 전역객체를 바라보는 문제를 보완하고자, this를 바인딩하지 않는 화살표 함수를 새로 도입햇다. 
- 화살표 함수는 실행 컨텍스트를 실행할 때 this 바인딩 과정 자체가 빠지게 되어, 상위 스코프의 this를 그대로 활용할 수 있다.
<br>

### ✨ 콜백 함수 호출 시 그 함수 내부에서의 this
- 콜백 함수의 제어권을 가지는 함수(메서드)가 콜백 함수에서의 this를 무엇으로 할지를 결정하며, 특별히 정의하지 않는 경우에는 기본적으로 함수와 마찬가지로 전역객체를 바라본다.
<br>

### ✨ 생성자 함수 내부에서의 this
- new 명령어와 함께 함수를 호출하면 해당 함수가 생성자로서 동작하게 된다.
- 어떤 함수가 생성자 함수로서 호출된 경우 내부에서의 this는 곧 새로 만들 구체적인 인스턴스 자신이 된다. 
<br>

## 📌 명시적으로 this를 바인딩하는 방법
### ✨ call 메서드
```js
Function.prototype.call(thisArg[, arg1[, arg2[, ...]]])
```
- call 메서드는 메서드의 호출 주체인 함수를 즉시 실행하도록 하는 명령
- call 메서드의 첫 번째 인자를 this로 바인딩하고, 이후의 인자들을 호출할 함수의 매개변수로 한다.
- 함수를 그냥 실행하면 this는 전역객체를 참조하지만 call 메서드를 이용하면 임의의 객체를 this로 지정할 수 있다. 
<br>
  
### ✨ apply 메서드
```js
Function.prototype.apply(thisArg[, argsArray])
```
- apply 메서드는 call 메서드와 기능적으로 완전히 동일하다.
- call 메서드는 첫 번째 인자를 제외한 나머지 모든 인자들을 호출할 함수의 매개변수로 지정하는 반면,
 apply 메서드는 두 번째 인자를 배열로 받아 그 배열의 요소들을 호출할 함수의 매개변수로 지정한다는 점에서만 차이가 있다.
<br>
   
### ✨ call / apply 메서드의 활용
- 유사배열객체에 배열 메서드를 적용
- 생성자 내부에서 다른 생성자를 호출
- 여러 인수를 묶어 하나의 배열로 전달하고 싶을 때: apply 사용
<br>
  
### ✨ bind 메서드
```js
Function.prototype.bind(thisArg[, arg1[, arg2]]])
```
- bind 메서드는 call과 비슷하지만 즉시 호출하지는 않고 넘겨받은 this 및 인수들을 바탕으로 새로운 함수를 반환하기만 하는 메서드이다.
- 다시 새로운 함수를 호출할 때 인수를 넘기면 그 인수들은 기존 bind 메서드를 호출할 때 전달했던 인수들의 뒤에 이어서 등록된다.
- 즉 bind 메서드는 함수에 this를 미리 적용하는 것과 부분 적용 함수를 구현하는 두 가지 목적을 모두 지닌다. 
- bind 메서드를 적용해서 새로 만든 함수의 특징: name 프로퍼티에 동사 bind의 수동태인 'bound'라는 접두어가 붙는다. 
```js
var func = function (a, b, c, d) {
	console.log(this, a, b, c, d);
};

var bindFunc = func.bind({ x: 1 }, 4, 5);
console.log(func.name); // func
console.log(bindFunc.name); // bound func
```
<br> 
  
### ✨ 화살표 함수의 예외사항
- 콜백 함수 내부에는 this가 아예 없으며, 접근하고자 하면 스코프체인상 가장 가까운 this에 접근하게 된다. 
<br>
  
### ✨ 별도의 인자로 this를 받는 경우(콜백 함수 내에서의 this)
- 콜백 함수를 인자로 받는 메서드 중 일부는 추가로 this로 지정할 객체(thisArg)를 인자로 지정할 수 있는 경우가 있다.
- 이러한 메서드의 thisArg 값을 지정하면 콜백 함수 내부에서의 this 값을 원하는 대로 변경할 수 있다. 
